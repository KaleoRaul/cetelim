{"version":3,"file":"index.es.js","sources":["../node_modules/invariant/invariant.js","../src/helpers.js","../src/components/Trap/Trap.js"],"sourcesContent":["/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\n\nvar NODE_ENV = process.env.NODE_ENV;\n\nvar invariant = function(condition, format, a, b, c, d, e, f) {\n  if (NODE_ENV !== 'production') {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    var error;\n    if (format === undefined) {\n      error = new Error(\n        'Minified exception occurred; use the non-minified dev environment ' +\n        'for the full error message and additional helpful warnings.'\n      );\n    } else {\n      var args = [a, b, c, d, e, f];\n      var argIndex = 0;\n      error = new Error(\n        format.replace(/%s/g, function() { return args[argIndex++]; })\n      );\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1; // we don't care about invariant's own frame\n    throw error;\n  }\n};\n\nmodule.exports = invariant;\n","export const asArray = input => {\r\n  let output;\r\n  if (!Array.isArray(input)) {\r\n    output = [input];\r\n  } else {\r\n    output = input;\r\n  }\r\n\r\n  return output;\r\n};\r\n","import { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport invariant from \"invariant\";\r\nimport { asArray } from \"../../helpers\";\r\n\r\nclass Trap extends Component {\r\n  static propTypes = {\r\n    /** children as function: (trapped, ref) => <YourComponent ... /> */\r\n    children: PropTypes.func.isRequired,\r\n    /** DOM event to habdle both in and out events */\r\n    event: PropTypes.oneOfType([\r\n      PropTypes.string,\r\n      PropTypes.arrayOf(PropTypes.string)\r\n    ]),\r\n    /** DOM event just for the focus, working in combination with the off prop  */\r\n    on: PropTypes.oneOfType([\r\n      PropTypes.string,\r\n      PropTypes.arrayOf(PropTypes.string)\r\n    ]),\r\n    /** DOM event just for the blur, working in combination with the on prop  */\r\n    off: PropTypes.oneOfType([\r\n      PropTypes.string,\r\n      PropTypes.arrayOf(PropTypes.string)\r\n    ]),\r\n    /** This will prevent the default (only if the state has changed) */\r\n    preventDefault: PropTypes.bool\r\n  };\r\n\r\n  static defaultProps = {\r\n    event: \"click\",\r\n    on: \"\",\r\n    off: \"\",\r\n    preventDefault: false\r\n  };\r\n\r\n  state = {\r\n    trapped: false\r\n  };\r\n\r\n  componentDidMount() {\r\n    const { event, on, off } = this.props;\r\n    invariant(\r\n      this.ref && this.ref.contains,\r\n      \"A ref is required, did you forgot to use it?\"\r\n    );\r\n    if (on && off) {\r\n      asArray(on).forEach(evt => {\r\n        document.addEventListener(evt, this.handleFocusEvent, {\r\n          detail: { reactTrap: true }\r\n        });\r\n      });\r\n      asArray(off).forEach(evt => {\r\n        document.addEventListener(evt, this.handleBlurEvent, {\r\n          detail: { reactTrap: true }\r\n        });\r\n      });\r\n    } else {\r\n      asArray(event).forEach(evt => {\r\n        document.addEventListener(evt, this.handleEvent, {\r\n          detail: { reactTrap: true }\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    const { event, on, off } = this.props;\r\n\r\n    if (on && off) {\r\n      asArray(on).forEach(evt => {\r\n        document.removeEventListener(evt, this.handleFocusEvent);\r\n      });\r\n      asArray(off).forEach(evt => {\r\n        document.removeEventListener(evt, this.handleBlurEvent);\r\n      });\r\n    } else {\r\n      asArray(event).forEach(evt => {\r\n        document.removeEventListener(evt, this.handleEvent);\r\n      });\r\n    }\r\n  }\r\n\r\n  preventDefaultHelper = (e, nextTrapped) => {\r\n    const { preventDefault } = this.props;\r\n    const { trapped } = this.state;\r\n    if (trapped !== nextTrapped && preventDefault) {\r\n      e.preventDefault();\r\n    }\r\n  };\r\n\r\n  handleEvent = e => {\r\n    const trapped = this.ref.contains(e.target);\r\n    this.preventDefaultHelper(e, trapped);\r\n    this.setState({ trapped });\r\n  };\r\n\r\n  handleFocusEvent = e => {\r\n    const trapped = this.ref.contains(e.target);\r\n    this.preventDefaultHelper(e, trapped);\r\n    if (trapped) {\r\n      this.setState({ trapped: true });\r\n    }\r\n  };\r\n\r\n  handleBlurEvent = e => {\r\n    const trapped = this.ref.contains(e.target);\r\n    this.preventDefaultHelper(e, trapped);\r\n    if (!trapped) {\r\n      this.setState({ trapped: false });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { children } = this.props;\r\n    const { trapped } = this.state;\r\n    invariant(\r\n      typeof children === \"function\",\r\n      'The \"children\" prop must be a function'\r\n    );\r\n    return children(trapped, ref => (this.ref = ref));\r\n  }\r\n}\r\n\r\nexport default Trap;\r\n"],"names":["asArray","input","output","Array","isArray","Trap","trapped","e","nextTrapped","preventDefault","props","state","ref","contains","target","preventDefaultHelper","setState","event","on","off","invariant","forEach","evt","document","addEventListener","handleFocusEvent","detail","reactTrap","handleBlurEvent","handleEvent","removeEventListener","children","Component","PropTypes","func","isRequired","oneOfType","string","arrayOf","bool"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;;;;;;;AAoBA,IAAI,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC;;AAEpC,IAAI,SAAS,GAAG,SAAS,SAAS,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;EAC5D,IAAI,QAAQ,KAAK,YAAY,EAAE;IAC7B,IAAI,MAAM,KAAK,SAAS,EAAE;MACxB,MAAM,IAAI,KAAK,CAAC,8CAA8C,CAAC,CAAC;KACjE;GACF;;EAED,IAAI,CAAC,SAAS,EAAE;IACd,IAAI,KAAK,CAAC;IACV,IAAI,MAAM,KAAK,SAAS,EAAE;MACxB,KAAK,GAAG,IAAI,KAAK;QACf,oEAAoE;QACpE,6DAA6D;OAC9D,CAAC;KACH,MAAM;MACL,IAAI,IAAI,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;MAC9B,IAAI,QAAQ,GAAG,CAAC,CAAC;MACjB,KAAK,GAAG,IAAI,KAAK;QACf,MAAM,CAAC,OAAO,CAAC,KAAK,EAAE,WAAW,EAAE,OAAO,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC;OAC/D,CAAC;MACF,KAAK,CAAC,IAAI,GAAG,qBAAqB,CAAC;KACpC;;IAED,KAAK,CAAC,WAAW,GAAG,CAAC,CAAC;IACtB,MAAM,KAAK,CAAC;GACb;CACF,CAAC;;AAEF,eAAc,GAAG,SAAS,CAAC;;AClDpB,IAAMA,OAAO,GAAG,SAAVA,OAAU,CAAAC,KAAK,EAAI;MAC1BC,MAAJ;;MACI,CAACC,KAAK,CAACC,OAAN,CAAcH,KAAd,CAAL,EAA2B;IACzBC,MAAM,GAAG,CAACD,KAAD,CAAT;GADF,MAEO;IACLC,MAAM,GAAGD,KAAT;;;SAGKC,MAAP;CARK;;ICKDG;;;;;;;;;;;;;;;;;;oFA8BI;MACNC,OAAO,EAAE;;;mGA8CY,UAACC,CAAD,EAAIC,WAAJ,EAAoB;UACjCC,cADiC,GACd,MAAKC,KADS,CACjCD,cADiC;UAEjCH,OAFiC,GAErB,MAAKK,KAFgB,CAEjCL,OAFiC;;UAGrCA,OAAO,KAAKE,WAAZ,IAA2BC,cAA/B,EAA+C;QAC7CF,CAAC,CAACE,cAAF;;;;0FAIU,UAAAF,CAAC,EAAI;UACXD,OAAO,GAAG,MAAKM,GAAL,CAASC,QAAT,CAAkBN,CAAC,CAACO,MAApB,CAAhB;;YACKC,oBAAL,CAA0BR,CAA1B,EAA6BD,OAA7B;;YACKU,QAAL,CAAc;QAAEV,OAAO,EAAPA;OAAhB;;;+FAGiB,UAAAC,CAAC,EAAI;UAChBD,OAAO,GAAG,MAAKM,GAAL,CAASC,QAAT,CAAkBN,CAAC,CAACO,MAApB,CAAhB;;YACKC,oBAAL,CAA0BR,CAA1B,EAA6BD,OAA7B;;UACIA,OAAJ,EAAa;cACNU,QAAL,CAAc;UAAEV,OAAO,EAAE;SAAzB;;;;8FAIc,UAAAC,CAAC,EAAI;UACfD,OAAO,GAAG,MAAKM,GAAL,CAASC,QAAT,CAAkBN,CAAC,CAACO,MAApB,CAAhB;;YACKC,oBAAL,CAA0BR,CAA1B,EAA6BD,OAA7B;;UACI,CAACA,OAAL,EAAc;cACPU,QAAL,CAAc;UAAEV,OAAO,EAAE;SAAzB;;;;;;;;;wCArEgB;;;wBACS,KAAKI,KADd;UACVO,KADU,eACVA,KADU;UACHC,EADG,eACHA,EADG;UACCC,GADD,eACCA,GADD;MAElBC,WAAS,CACP,KAAKR,GAAL,IAAY,KAAKA,GAAL,CAASC,QADd,EAEP,8CAFO,CAAT;;UAIIK,EAAE,IAAIC,GAAV,EAAe;QACbnB,OAAO,CAACkB,EAAD,CAAP,CAAYG,OAAZ,CAAoB,UAAAC,GAAG,EAAI;UACzBC,QAAQ,CAACC,gBAAT,CAA0BF,GAA1B,EAA+B,MAAI,CAACG,gBAApC,EAAsD;YACpDC,MAAM,EAAE;cAAEC,SAAS,EAAE;;WADvB;SADF;QAKA3B,OAAO,CAACmB,GAAD,CAAP,CAAaE,OAAb,CAAqB,UAAAC,GAAG,EAAI;UAC1BC,QAAQ,CAACC,gBAAT,CAA0BF,GAA1B,EAA+B,MAAI,CAACM,eAApC,EAAqD;YACnDF,MAAM,EAAE;cAAEC,SAAS,EAAE;;WADvB;SADF;OANF,MAWO;QACL3B,OAAO,CAACiB,KAAD,CAAP,CAAeI,OAAf,CAAuB,UAAAC,GAAG,EAAI;UAC5BC,QAAQ,CAACC,gBAAT,CAA0BF,GAA1B,EAA+B,MAAI,CAACO,WAApC,EAAiD;YAC/CH,MAAM,EAAE;cAAEC,SAAS,EAAE;;WADvB;SADF;;;;;2CAQmB;;;yBACM,KAAKjB,KADX;UACbO,KADa,gBACbA,KADa;UACNC,EADM,gBACNA,EADM;UACFC,GADE,gBACFA,GADE;;UAGjBD,EAAE,IAAIC,GAAV,EAAe;QACbnB,OAAO,CAACkB,EAAD,CAAP,CAAYG,OAAZ,CAAoB,UAAAC,GAAG,EAAI;UACzBC,QAAQ,CAACO,mBAAT,CAA6BR,GAA7B,EAAkC,MAAI,CAACG,gBAAvC;SADF;QAGAzB,OAAO,CAACmB,GAAD,CAAP,CAAaE,OAAb,CAAqB,UAAAC,GAAG,EAAI;UAC1BC,QAAQ,CAACO,mBAAT,CAA6BR,GAA7B,EAAkC,MAAI,CAACM,eAAvC;SADF;OAJF,MAOO;QACL5B,OAAO,CAACiB,KAAD,CAAP,CAAeI,OAAf,CAAuB,UAAAC,GAAG,EAAI;UAC5BC,QAAQ,CAACO,mBAAT,CAA6BR,GAA7B,EAAkC,MAAI,CAACO,WAAvC;SADF;;;;;6BAoCK;;;UACCE,QADD,GACc,KAAKrB,KADnB,CACCqB,QADD;UAECzB,OAFD,GAEa,KAAKK,KAFlB,CAECL,OAFD;MAGPc,WAAS,CACP,OAAOW,QAAP,KAAoB,UADb,EAEP,wCAFO,CAAT;aAIOA,QAAQ,CAACzB,OAAD,EAAU,UAAAM,GAAG;eAAK,MAAI,CAACA,GAAL,GAAWA,GAAhB;OAAb,CAAf;;;;;EAlHeoB;;gBAAb3B,mBACe;;EAEjB0B,QAAQ,EAAEE,SAAS,CAACC,IAAV,CAAeC,UAFR;;;EAIjBlB,KAAK,EAAEgB,SAAS,CAACG,SAAV,CAAoB,CACzBH,SAAS,CAACI,MADe,EAEzBJ,SAAS,CAACK,OAAV,CAAkBL,SAAS,CAACI,MAA5B,CAFyB,CAApB,CAJU;;;EASjBnB,EAAE,EAAEe,SAAS,CAACG,SAAV,CAAoB,CACtBH,SAAS,CAACI,MADY,EAEtBJ,SAAS,CAACK,OAAV,CAAkBL,SAAS,CAACI,MAA5B,CAFsB,CAApB,CATa;;;EAcjBlB,GAAG,EAAEc,SAAS,CAACG,SAAV,CAAoB,CACvBH,SAAS,CAACI,MADa,EAEvBJ,SAAS,CAACK,OAAV,CAAkBL,SAAS,CAACI,MAA5B,CAFuB,CAApB,CAdY;;;EAmBjB5B,cAAc,EAAEwB,SAAS,CAACM;;;gBApBxBlC,sBAuBkB;EACpBY,KAAK,EAAE,OADa;EAEpBC,EAAE,EAAE,EAFgB;EAGpBC,GAAG,EAAE,EAHe;EAIpBV,cAAc,EAAE;;;;;"}